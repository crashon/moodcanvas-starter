# 크레인 게임 기능정의서 (Feature Specification)

## 프로젝트 개요
- **프로젝트명**: 웹용 크레인 게임 (Web Crane Game)
- **버전**: 1.0.0
- **개발일**: 2024
- **플랫폼**: 웹 브라우저 (Three.js + Cannon-es)

## 핵심 게임플레이

### 1. 기본 게임 메커니즘
- **목표**: 크레인을 조작하여 경품을 잡고 오른쪽 출구로 넣어 점수 획득
- **시간 제한**: 난이도별 45-90초
- **승리 조건**: 제한 시간 내 최대한 많은 점수 획득

### 2. 조작 시스템
#### 키보드 조작
- **이동**: WASD 또는 방향키
- **집게 제어**: Space (누르면 내려가며 닫힘, 떼면 올라가며 열림)
- **기타**: ESC (도움말 닫기)

#### 모바일 터치 조작
- **방향 버튼**: 화면 우하단 4방향 버튼
- **집게 버튼**: GRAB 버튼 (터치 시 내림, 떼면 올림)

## 물리 엔진 및 3D 구현

### 3. 물리 시뮬레이션
- **엔진**: Cannon-es 물리 엔진
- **중력**: 실제 중력값 적용 (-9.82)
- **마찰**: 경품별 차별화된 마찰 계수
- **충돌 감지**: 정밀한 AABB 및 구 충돌 검사

### 4. 3D 크레인 시스템
#### 크레인 구조
- **가대**: X/Z축 이동 가능한 캐리지
- **로프**: 거리 제약으로 후크 연결
- **후크**: 중력에 의해 자연스럽게 매달림
- **3발 집게**: 힌지 조인트로 연결된 물리적 집게

#### 집게 메커니즘
- **힌지 조인트**: 각 손가락이 후크에 힌지로 연결
- **모터 제어**: 닫힘/열림 속도 및 힘 조절 가능
- **각도 제한**: 과도한 회전 방지
- **물리적 잡기**: 실제 마찰과 힘으로 경품 포착

### 5. 경품 시스템
#### 경품 종류
- **봉제 인형**: 구 형태, 부드러운 마찰
- **휴대폰 케이스**: 박스 형태, 낮은 마찰
- **물리 속성**: 크기, 질량, 마찰 계수 랜덤화

## 게임 시스템

### 6. 난이도 시스템
#### 난이도별 설정
- **Easy**: 90초, 집게 힘 14, 닫힘 속도 -2.2
- **Normal**: 60초, 집게 힘 12, 닫힘 속도 -2.0  
- **Hard**: 45초, 집게 힘 10, 닫힘 속도 -1.7

### 7. 점수 및 콤보 시스템
#### 점수 획득
- **기본 점수**: 경품 1개당 1점
- **콤보 시스템**: 3초 내 연속 득점 시 콤보 증가
- **콤보 보너스**: 피치 상승, 색상 변화, 시각 효과

#### 최고점 관리
- **자동 저장**: localStorage에 최고점 저장
- **실시간 업데이트**: 최고점 갱신 시 즉시 반영
- **초기화 기능**: 확인 대화상자와 함께 최고점 리셋

### 8. 코인 시스템
- **코인 투입**: 버튼으로 코인 추가
- **게임 시작**: 코인 소모하여 게임 시작
- **잔액 표시**: 실시간 코인 수량 표시

## UI/UX 시스템

### 9. HUD (Head-Up Display)
#### 게임 정보 표시
- **점수**: 현재 점수, 최고점, 남은 시간
- **FPS**: 실시간 프레임률 (색상 코딩)
- **코인**: 현재 보유 코인 수

#### 컨트롤 버튼
- **코인 투입**: 코인 추가
- **시작**: 게임 시작 (코인 소모)
- **일시정지/재개**: 게임 일시정지
- **카메라 전환**: 탑뷰/일반뷰 전환
- **도움말**: 조작법 표시
- **최고점 초기화**: 최고점 리셋

### 10. 미니맵 시스템
#### 미니맵 기능
- **실시간 렌더링**: 별도 카메라로 탑다운 뷰
- **캐리지 추적**: 크레인 위치 실시간 표시
- **경계 표시**: 아레나 경계선 표시
- **출구 아이콘**: 목표 지점 삼각형 아이콘
- **그리드 옵션**: 선택적 격자 표시

### 11. 도움말 시스템
#### 조작법 가이드
- **첫 방문**: 자동으로 도움말 표시
- **상세 설명**: 이동, 집게, 목표, 난이도, 모바일 조작법
- **키보드 단축키**: ESC로 닫기

## 오디오 시스템

### 12. 사운드 효과
#### WebAudio 기반 사운드
- **집게 닫힘**: 사각파 비프 (320Hz)
- **득점**: 사인파 비프 (880Hz + 1320Hz)
- **콤보**: 피치 상승 효과
- **음소거**: 토글 가능한 사운드 끄기

## 성능 및 옵션

### 13. 성능 최적화
#### 렌더링 옵션
- **그림자**: 토글 가능한 그림자 렌더링
- **파티클**: 득점 시 파티클 효과 토글
- **미니맵 그리드**: 선택적 격자 표시

#### 성능 모니터링
- **FPS 표시**: 실시간 프레임률
- **색상 코딩**: 초록(≥50), 노랑(≥30), 빨강(<30)
- **자동 일시정지**: 탭 전환 시 게임 일시정지

### 14. 설정 저장
#### localStorage 기반 저장
- **게임 설정**: 그림자, 파티클, 그리드 옵션
- **최고점**: 자동 저장 및 복원
- **방문 기록**: 첫 방문 감지

## 리플레이 시스템

### 15. 녹화 및 재생
#### 입력 녹화
- **실시간 기록**: 키보드 입력 타임스탬프 저장
- **저장/불러오기**: localStorage에 리플레이 데이터 저장
- **메타데이터**: 점수, 난이도, 타임스탬프 포함

#### 재생 기능
- **속도 조절**: 0.5x, 1x, 2x 재생 속도
- **입력 시각화**: 재생 중 키 입력 화면 표시
- **자동 종료**: 리플레이 완료 시 자동 정지

## 업적 시스템

### 16. 업적 알림
#### 업적 조건
- **첫 득점**: 첫 번째 경품 획득
- **5점 달성**: 5점 달성
- **10점 달성**: 10점 달성  
- **콤보**: 3회 이상 연속 득점

#### 알림 시스템
- **슬라이드 애니메이션**: 우측에서 슬라이드 인
- **자동 사라짐**: 2초 후 자동 제거
- **그라데이션**: 노랑-빨강 그라데이션 배경

## 기술 스택

### 17. 사용 기술
#### 프론트엔드
- **Three.js**: 3D 렌더링 엔진
- **Cannon-es**: 물리 시뮬레이션
- **WebAudio API**: 사운드 생성
- **localStorage**: 데이터 저장

#### 백엔드
- **Python HTTP Server**: 정적 파일 서빙
- **포트**: 8000번 포트 사용

## 파일 구조

### 18. 프로젝트 구조
```
cranegame/
├── main.py              # Python 서버
├── index.html           # 메인 HTML
├── web/
│   └── main.js         # 게임 로직
├── README.md           # 프로젝트 설명
└── FEATURE_SPEC.md     # 기능정의서
```

## 브라우저 호환성

### 19. 지원 브라우저
- **Chrome**: 권장 (최신 버전)
- **Firefox**: 지원
- **Safari**: 지원
- **Edge**: 지원
- **모바일**: iOS Safari, Android Chrome

## 향후 확장 가능성

### 20. 추가 기능 아이디어
- **다양한 경품**: 더 많은 3D 모델
- **멀티플레이어**: 실시간 대전
- **레벨 시스템**: 단계별 난이도
- **커스터마이징**: 크레인/경품 스킨
- **통계**: 상세한 게임 통계
- **소셜 기능**: 점수 공유, 리더보드

---

**문서 버전**: 1.0  
**최종 업데이트**: 2024년  
**작성자**: AI Assistant
